- 3种常用的缓存读写策略
旁路缓存：同时更新缓存和db，但是以db为准
穿透：优先更新缓存，更新完缓存，缓存头更新db，读不到缓存，就读取db，然后更新缓存
异步写db：读写都是缓存，然后异步写db
- [旁路缓存模式]在写数据的过程中，可以先删除 cache ，后更新 db 么？

不可以，会造成数据不同步

- [旁路缓存模式]在写数据的过程中，先更新 db，后删除 cache 就没有问题了么？

也不是，但是几率小很多，因为写缓存非常快

- 旁路缓存模式有什么缺陷？

频繁写，可能会造成命中率低
首次读，缓存没有值，都是穿透，可以预热一下

- Redis有哪些数据结构?

String：token session
List：双向链表，范围查询
Set：不重复数据
ZSet：有序
Hash：快速查询

- Redis 3 种特殊数据结构

bitmap：非常小，节省内存
hyperloglog：可以存储非常大的值
geo：存储地理位置

- Redis持久化机制
rdb
aof
混合


- 什么是 RDB 持久化？

将数据的当时的镜像压缩保存下来二进制，一般是设置每隔多长时间执行一次

- RDB 创建快照时会阻塞主线程吗？

bgsave不会
手动save会

- 什么是 AOF 持久化？

每次有数据更新，将数据更新到aof缓存中，然后写入aof文件，根据持久化方式，选择保存到磁盘的方式

- AOF 工作基本流程是怎样的？

同上

- 持久化方式有哪些？

1. 每次有数据更新，立刻持久化
2. 每秒持久化
3. 基于操作系统，linux一般是30s一次

- AOF 为什么是在执行完命令之后记录日志？

避免阻塞命令
不校验命令

缺陷：阻塞后续命令

- AOF 重写了解吗？

aof随着文件过大，会执行重写，重写的指令只保存最后一条写入的，其它的更新或者中间记录都会被清掉，所以文件会大大减少

- 如何选择 RDB 和 AOF？

rdb 更新频率没那么高，而且每次比较占用内存，而且保存的都是压缩的二进制指令，可读性不高，但是恢复的时候比较容易和快速
aof：更新频率更高，内存占用少，但是文件比较大，即使压缩也比rdb大，可读性高，因为里面存的都是sql指令，但是恢复比较慢，是要一条条执行指令
可以混用：aof持久化时，把rdb写入aof文件头部

- redis应用

内存型数据库，分布式锁，分布式缓存，pub/sub

- 如何基于 Redis 实现分布式锁？

setIfAbsent写入锁，如果写入成功说明获取到锁了，写入失败说明锁被占用，最好加个超时时间，避免锁释放异常导致锁永远不会被释放
delete释放锁

redisson

- 过期的数据的删除策略了解么？

惰性删除：只有到查到了这个key的时候，才执行过期数据删除检测
定期删除：每隔一段时间，选取一段数据删除

- Redis 单线程模型了解吗？

一个线程负责处理客户端的连接，io多路复用

- Redis 和 Memcached 的区别和共同点

-Redis 支持分布式的，持久化的，崩溃恢复等
- 支持多种数据格式
- 集群
- pub/sub