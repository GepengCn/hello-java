- 3种常用的缓存读写策略

旁路缓存模式 先缓存，再db



- [旁路缓存模式]在写数据的过程中，可以先删除 cache ，后更新 db 么？

不能，并发会导致不一致了

- [旁路缓存模式]在写数据的过程中，先更新 db，后删除 cache 就没有问题了么？

也不绝对，但是写缓存非常快，出现的概率较小

- 旁路缓存模式有什么缺陷？

初始化没有缓存
不一致

- Redis有哪些数据结构?

String 常用，存储字符串，存个token session了，分布式锁
List 双向链表，适合范围查询，最新5条数据等
Set 不重复的，适合求个差集并集之类的
ZSet 可排序的Set
Hash 哈希表结构，适合存个随机查询的

- Redis 3 种特殊数据结构

bitmap
每个存储位一byte，适合存储大量数字

hytrologlog

存储海量数据用的

geo

存储地理位置

- Redis持久化机制

rdb
aof
混合

- 什么是 RDB 持久化？

快照存储，某个时间点的内存数据镜像压缩保存下来，支持定时的rdb持久化

save bgsave

- RDB 创建快照时会阻塞主线程吗？

手动save会
bgsave不会

- 什么是 AOF 持久化？

每次数据变动，都会保存到aof缓冲区，然后再保存到aof文件，最后根据持久化策略，保存到磁盘

- AOF 工作基本流程是怎样的？

每次数据变动，都会保存到aof缓冲区，然后再保存到aof文件，最后根据持久化策略，保存到磁盘

- 持久化方式有哪些？

每次数据更新立刻持久化
每秒持久化
系统决定持久化间隔时间

- AOF 为什么是在执行完命令之后记录日志？

不校验命令
不阻塞执行命令


- AOF 重写了解吗？

aof随着数据变更多了会越来越大，随意当达到一定大小会重写，将aof文件缩小

原理就是，重写只保留最后一次的写入记录，之前那些更新等操作，都不记录了

- 如何选择 RDB 和 AOF？

rdb适合经过压缩，文件更小，恢复也更容易，但是可读性不强，实时性没那么强
aof更清量，实时性更强，文件会更大，即使重写了也会更大，恢复需要一条条执行语句，但是可读性很强
可以选择混合模式

- redis应用

分布式锁，队列，缓存

- 如何基于 Redis 实现分布式锁？

setIfAbsent 如果写入成功，说明获取到锁，如果写入不成功，说明没获取到锁
delete释放锁
最好加个过期时间，避免锁长时间未释放
redisson

- 过期的数据的删除策略了解么？

惰性删除：用的这个key的时候再判断是否需要过期删除
定期删除：隔一段时间挑一批进行删除

- Redis 单线程模型了解吗？

一个线程负责处理所有的请求，多路复用模式

- Redis 和 Memcached 的区别和共同点

redis支持分布式，持久化，崩溃恢复，lua脚本
支持更多数据格式